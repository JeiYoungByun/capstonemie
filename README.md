# DIY Smart Mirror with User Recognition

## 📝 프로젝트 소개

**"거울아, 거울아, 나에게 맞는 정보를 보여다오."**

저희가 진행하는 프로젝트는 단순한 정보 표시를 넘어, **사용자를 스스로 인식하고 개인에게 최적화된 정보를 제공하는** 지능형 스마트 미러입니다. 오픈 소스인 MagicMirror² 플랫폼을 기반으로 라즈베리파이 위에 자체 개발한 **얼굴 인식 AI 모듈**을 탑재하여, 거울 앞에 서는 사람에 따라 전혀 다른 경험을 제공하는 것을 목표로 합니다.

다음과 같은 핵심 기능들을 구현합니다.

  - **사용자별 맞춤 정보**: 얼굴 인식을 통해 가족 구성원을 구분하고, 개인별 캘린더, 뉴스 피드, 할 일 목록 등을 자동으로 표시합니다.
  - **기본 정보 표시**: 시간, 날짜, 현재 위치 기반의 날씨 및 미세먼지 정보를 제공합니다.
  - **개인화된 콘텐츠**: 사용자에 따라 구글 캘린더 일정, 관심 분야 뉴스를 선별하여 제공합니다.
  - **스마트폰 데이터 연동**: 기존 앱과 연동하여 스마트폰의 데이터를 거울에 표시하는 기능을 구현합니다.
  - **독자 개발 AI 기능**: 라즈베리파이 환경에 최적화된 **'실시간 사용자 인식 API'** 를 직접 개발하고 적용합니다.

<br/>

## 🤔 우리가 해결하려는 문제: '나'를 위한 정보

기존 스마트 미러는 모든 사용자에게 동일한 정보를 보여주는 **'공용 게시판'** 에 가까웠습니다. 하지만 가족 구성원 각자가 필요로 하는 정보는 모두 다릅니다.

  - **문제점**: 아빠는 경제 뉴스와 출근길 교통 정보가, 엄마는 오늘 장 볼 목록과 자녀의 학원 시간이, 아이는 오늘의 급식 메뉴와 준비물이 궁금합니다. 기존 스마트 미러는 이 모든 정보를 한 화면에 욱여넣거나, 한 가지 정보만 선택해야 했습니다.

  - **해결책**: 저희 스마트 미러는 거울 앞에 서는 순간, 카메라가 사용자를 인식하여 **'나만의 개인 비서'** 로 변신합니다. 아빠에게는 아빠의 일정을, 엄마에게는 엄마의 할 일을, 아이에게는 아이의 시간표를 보여주어, 불필요한 정보 속에서 헤매지 않고 **가장 중요한 정보에 집중**할 수 있도록 돕습니다. 이는 바쁜 아침 시간을 더욱 효율적으로 만들고, 가족 구성원 간의 프라이버시를 지켜줍니다.

<br/>

## 🔬 선행 특허 기술 분석 및 차별점

프로젝트 기획 단계에서, 유사 아이디어의 선행 특허들을 분석하여 저희 프로젝트의 기술적 차별점을 명확히 했습니다.

  - **선행 특허의 핵심**: '얼굴 인식을 통해 사용자를 식별하고, 개인화된 정보를 스마트 미러에 표시한다'는 기본 아이디어는 다수의 선행 특허(예: US 10,810,912 B2)에서 이미 다루고 있었습니다. 대부분의 특허는 이 아이디어를 **개념적**으로 제시하는 데 그칩니다.

  - **저희 프로젝트의 차별점**: 저희는 개념을 넘어 **'어떻게 구현할 것인가'** 에 집중했습니다.

    1.  **특정 하드웨어 최적화**: **라즈베리파이**라는 저전력/저사양 환경에서 실시간 얼굴 인식이 원활하게 동작하도록 하는 기술적 문제를 해결합니다.
    2.  **최신 경량 AI 모델 적용**: 검증된 고성능 라이브러리인 **`face_recognition`(Dlib 기반)** 을 사용하여, 제한된 자원 내에서 높은 정확도와 빠른 인식 속도를 동시에 확보하는 구체적인 방법을 제시합니다.
    3.  **오픈소스 생태계 활용**: 안정적이고 확장성 높은 **MagicMirror²** 플랫폼에 자체 개발 AI 모듈을 통합하는 전체 시스템 아키텍처를 설계하여, 아이디어의 **실현 가능성**과 **안정성**을 높였습니다.

결론적으로, 저희 프로젝트는 단순히 아이디어를 제시하는 것을 넘어, **현실적인 하드웨어 제약 속에서 최신 AI 기술과 오픈소스 플랫폼을 결합하여 아이디어를 구현하는 구체적이고 효율적인 방법에 대한 솔루션**이라는 점에서 선행 기술과 차별화됩니다.

<br/>

## 🖥️ 화면 구성 (사용자 인식 기반)

> 사용자 A(아빠)와 사용자 B(엄마)가 거울을 볼 때의 화면 구성 예시입니다.

| 사용자 A (아빠)가 인식되었을 때 | 사용자 B (엄마)가 인식되었을 때 |
| :---: | :---: |
| \<img src="[https://i.imgur.com/example-A.png](https://www.google.com/search?q=https://i.imgur.com/example-A.png)" width="400"/\> | \<img src="[https://i.imgur.com/example-B.png](https://www.google.com/search?q=https://i.imgur.com/example-B.png)" width="400"/\> |
| \<ul\>\<li\>**상단 좌측**: 오늘의 경제 뉴스 (RSS)\</li\>\<li\>**상단 우측**: 현재 날씨 및 출근길 교통 정보\</li\>\<li\>**캘린더**: 회사 구글 캘린더 연동\</li\>\<li\>**하단**: 주식 시세 정보\</li\>\</ul\> | \<ul\>\<li\>**상단 좌측**: 자녀 등원 시간 알림\</li\>\<li\>**상단 우측**: 현재 날씨 및 동네 미세먼지 정보\</li\>\<li\>**캘린더**: 개인 구글 캘린더 (장보기, 학부모 모임)\</li\>\<li\>**하단**: 오늘의 추천 레시피\</li\>\</ul\> |

<br/>

## ⚙️ 기술 스택 (Tech Stack)

### Hardware

  - **Raspberry Pi 4**: 프로젝트의 두뇌 역할을 하는 핵심 컴퓨팅 모듈입니다.
  - **USB Webcam**: **'사용자 인식 API'** 의 핵심 센서로, 영상 입력을 담당합니다.
  - **Display & Half Mirror**: 사용자 인터페이스(UI)를 표시하고, 거울 기능을 구현하는 핵심 부품입니다.
  - **USB Microphone & Speaker**: (선택) 음성 비서 기능 확장을 위한 주변 장치입니다.

### Core Software & Platform

  - **Raspberry Pi OS**: 안정적인 구동 환경을 제공하는 Debian 기반 운영체제입니다.
  - **MagicMirror²**: 모듈형 구조를 가진 오픈소스 스마트 미러 플랫폼으로, 프로젝트의 프레임워크 역할을 합니다.
  - **Node.js**: MagicMirror²의 런타임 환경으로, 서버 사이드 로직과 모듈 관리를 담당합니다.
  - **Python**: **'사용자 인식 API'** 를 구동하는 AI 추론 서버를 구축하는 데 사용됩니다.
  - **face\_recognition (Dlib)**: **높은 정확도(LFW 99.38%)** 가 검증되었으며, 라즈베리파이 환경에서도 안정적으로 구동되는 얼굴 인식 라이브러리입니다.

### APIs & Tools

  - **자체 개발 API**:
      - **사용자 인식 API (User Recognition API)**: 카메라로 입력된 얼굴을 실시간으로 분석하여 등록된 사용자인지 판별하고, 사용자의 고유 ID를 MagicMirror² 플랫폼으로 전송하는 역할을 합니다.
  - **외부 API**:
      - **OpenWeatherMap API**: 날씨 및 미세먼지 데이터를 가져옵니다.
      - **Google Calendar API**: 개인/공용 구글 캘린더 일정을 연동합니다.
      - **NewsAPI**: 사용자 관심사에 맞는 뉴스 헤드라인을 가져옵니다.
  - **Tools**:
      - **Git & Github**: 소스 코드 버전 관리 및 협업을 위해 사용합니다.
      - **SSH**: 원격으로 라즈베리파이에 접속하여 개발 및 설정을 진행합니다.
      - **PM2**: Node.js 애플리케이션(MagicMirror)을 백그라운드에서 안정적으로 실행하고 관리하는 프로세스 매니저입니다.

<br/>

## 🛠️ 프로젝트 아키텍처

본 프로젝트는 **마이크로서비스 아키텍처(MSA)** 개념을 차용하여, 메인 애플리케이션과 AI 서버를 분리하고 독립적으로 동작하도록 설계했습니다.

  - **Node.js Main Server (MagicMirror²)**: UI 렌더링과 기본 정보 모듈(날씨, 시계, 캘린더 등)의 제어를 담당합니다. 외부 API를 호출하고 화면에 정보를 표시하는 역할을 합니다.

  - **Python AI Server (Face Recognition)**: 독립적으로 실행되며, 카메라로부터 영상을 받아 얼굴 인식을 지속적으로 수행합니다. 사용자가 인식되면, 해당 사용자의 프로필 ID를 메인 서버로 전송합니다.

  - **Internal Communication (내부 통신)**: 두 서버는 **WebSocket 통신** 또는 **HTTP 요청**을 통해 실시간으로 데이터를 주고받습니다. AI 서버가 사용자를 인식하면, 메인 서버에 `SHOW_PROFILE: 'user_A'` 와 같은 알림(notification)을 보내고, 메인 서버는 이 알림에 따라 해당 사용자의 모듈들을 화면에 표시합니다.

> **데이터 흐름 예시**:
>
> 1.  **AI 서버**가 카메라 영상에서 사용자 A의 얼굴을 인식합니다.
> 2.  **AI 서버**가 **메인 서버**로 `'user_A'` 라는 ID를 전송합니다.
> 3.  **메인 서버**는 `'user_A'` 에게 설정된 모듈(회사 캘린더, 경제 뉴스)들을 화면에 표시하도록 명령합니다.
> 4.  잠시 후, 사용자 B가 거울 앞에 서면, **AI 서버**가 이를 인식하고 `'user_B'` ID를 전송합니다.
> 5.  **메인 서버**는 기존 모듈을 숨기고, `'user_B'` 에게 설정된 모듈(개인 캘린더, 레시피)들을 새로 표시합니다.

<br/>

## 🤔 기술적 이슈와 해결 과정

### 라즈베리파이에서 실시간 얼굴 인식 성능 확보

  - **문제점**: 라즈베리파이는 컴퓨팅 성능이 매우 제한적이어서, 무거운 AI 모델을 실행하면 초당 프레임(FPS)이 급격히 저하되어 실시간성을 잃게 됩니다. OpenCV의 기본 Haar Cascade 분류기는 속도는 빠르지만 정확도가 낮고, 최신 딥러닝 모델은 무거워서 사용하기 어렵습니다.

  - **해결 과정**:

    1.  **라이브러리 선정**: 다양한 라이브러리를 비교 검토한 결과, 정확도가 매우 높으면서도 C++로 최적화되어 라즈베리파이의 CPU만으로도 구동 가능한 **`face_recognition`(Dlib 기반)** 라이브러리를 최종 선택했습니다.
    2.  **성능 최적화**: 인식 속도를 더욱 높이기 위해, 매 프레임마다 인식을 수행하는 대신 \*\*2\~3 프레임에 한 번씩만 얼굴을 탐지(detection)\*\*하고, 탐지된 영역 안에서만 얼굴을 식별(recognition)하는 '추적 기반 인식' 방식을 적용하여 연산 부하를 줄였습니다.
    3.  **이미지 처리**: 처리할 영상의 해상도를 1/2 또는 1/4로 낮추어 AI 모델에 입력함으로써, 인식 정확도에 큰 영향을 주지 않으면서도 연산량을 획기적으로 줄여 FPS를 확보했습니다.

### 이기종 언어(Node.js-Python) 간의 통신 문제

  - **문제점**: MagicMirror²는 Node.js 기반이고, 얼굴 인식 모듈은 Python으로 개발해야 하므로 두 프로세스 간의 효율적인 통신 방법이 필요했습니다.

  - **해결 과정**: MagicMirror²가 기본적으로 제공하는 **모듈 간 알림(Notification) 시스템**을 적극 활용했습니다.

    1.  `MMM-PythonShell`과 같은 보조 모듈을 사용하여 Node.js 환경에서 Python 스크립트를 자식 프로세스로 실행시켰습니다.
    2.  Python 스크립트는 얼굴 인식이 성공할 때마다 표준 출력(stdout)으로 `USER_DETECTED: user_A` 와 같은 JSON 형식의 메시지를 출력합니다.
    3.  Node.js의 `PythonShell` 모듈은 이 메시지를 감지하여 MagicMirror²의 알림 시스템으로 전달합니다.
    4.  다른 모든 모듈들은 이 알림을 구독하고 있다가, 자신의 주인이 나타났다는 알림을 받으면 화면에 나타나고, 다른 사용자의 알림을 받으면 사라지도록 로직을 구현하여 문제를 해결했습니다.

<br/>

## 💁‍♂️ 프로젝트 팀원

| Project Lead & Developer |
| :---: |
| (팀원 정보) |
