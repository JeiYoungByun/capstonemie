# DIY Smart Mirror Project 

## 📝 소개

저희가 이번에 진행할 프로젝트는 DIY 스마트 미러 프로젝트입니다. 오픈 소스인 MagicMirror 플랫폼을 기반으로, 라즈베리파이 위에 다양한 모듈을 설치하여 개인 맞춤형 정보를 제공하는 거울을 제작합니다.

다음과 같은 핵심 기능들을 구현했습니다.

- 시간, 날짜, 날씨, 미세먼지 등 기본 정보 표시
- 구글 캘린더 연동을 통한 개인 일정 관리
- RSS 피드를 활용한 맞춤 뉴스 제공
- 구글 어시스턴트를 이용한 음성 명령 제어 (유튜브 재생, 정보 검색 등)
- 구글 포토와 연동한 디지털 액자 기능
- 터치 또는 센서를 이용한 화면 절전 모드 제어
- 독자 개발 AI 기능 : 카메라를 이용한 실시간 '디지털 피로도' 측정

<br />

## 🤔 스마트 미러가 해결할 수 있는 실생활 문제

스마트 미러는 바쁜 아침 시간의 **'정보 파편화'** 문제를 해결하고, 일상적인 공간을 **'지능형 정보 허브'**로 바꿔주는 역할을 합니다.

---

### 1. 정보의 통합과 시간 절약

* **문제점**: 바쁜 아침, 우리는 출근이나 등교 준비를 하면서 여러 정보를 확인해야 합니다. 스마트폰을 열어 날씨 앱을 보고, 캘린더 앱을 열어 오늘 일정을 확인하고, 포털 사이트에 들어가 뉴스를 봅니다. 이 과정은 번거롭고 시간을 뺏으며, 정신을 분산시킵니다.

* **해결책**: 스마트 미러는 이 모든 정보를 **'한눈에(At-a-glance)'** 볼 수 있도록 거울이라는 단일 공간에 통합하여 보여줍니다. 사용자는 칫솔질을 하거나 화장을 하는 등, 원래 하던 행동을 하면서 자연스럽게 오늘 날씨, 주요 뉴스, 잊지 말아야 할 약속 등을 한 번에 파악할 수 있습니다. 이를 통해 **아침 시간의 효율을 높이고 인지적 부담을 줄여줍니다.**

---

### 2. 일상 공간의 스마트 허브화

* **문제점**: 가족 구성원 간의 일정 공유, 중요한 공지사항 전달 등은 보통 메신저나 스마트폰 앱을 통해 이루어집니다. 하지만 이는 각자 확인해야 하는 번거로움이 있고, '나중에 봐야지' 하고 잊어버리기 쉽습니다.

* **해결책**: 스마트 미러는 욕실이나 현관처럼 **가족 모두가 매일 반드시 지나치는 공간에 설치**될 수 있습니다. 여기에 공유 캘린더, 가족사진, 오늘의 할 일 등을 띄워 놓으면, 자연스럽게 정보를 공유하는 **'가족용 디지털 게시판'** 역할을 수행할 수 있습니다. 또한, 음성 명령을 통해 조명이나 다른 가전제품을 제어하는 스마트홈 허브로 확장될 수도 있습니다.



---

### 3. 자연스러운 사용자 경험 (UX)

* **문제점**: 대부분의 스마트 기기는 우리가 '사용해야겠다'고 의식적으로 생각하고 조작해야 합니다. 태블릿을 켜거나, 스마트폰의 잠금을 해제하는 행동이 필요하죠.

* **해결책**: 거울은 우리가 **매일 의식하지 않고 자연스럽게 사용하는 사물**입니다. 스마트 미러는 이처럼 익숙한 사물에 정보를 녹여내어, 기술이 삶에 **'끼어든다'는 느낌 없이 자연스럽게 정보를 제공**합니다. 음성 비서(Google Assistant)와 시각 정보(디스플레이)의 결합은 사용자가 손을 쓸 수 없는 상황에서도 편리하게 정보를 얻고 기기를 제어할 수 있는 강력한 사용자 경험을 만들어냅니다.


</br>

## 화면 구성

> 최종적으로 완성된 스마트 미러의 화면 구성 예시입니다.

|                              최종 화면 구성                              |                                                                                                                       주요 기능                                                                                                                        |
| :----------------------------------------------------------------------: | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------: |
| <img src="https://github.com/JeiYoungByun/capstonemie/blob/main/%EC%99%84%EC%84%B1%ED%92%88%EC%98%88%EC%8B%9C.png?raw=true" width="400"/> | <ul><li>**상단 좌측**: 시계 및 날짜</li><li>**상단 우측**: 현재 날씨 및 주간 예보</li><li>**중앙**: 미세먼지 정보</li><li>**하단**: 뉴스 헤드라인 (RSS)</li><li>**캘린더**: 구글 캘린더 연동 일정</li><li>**백그라운드**: 구글 포토 연동 사진</li><ul> |

<br />

본 프로젝트는 다양한 외부 API와 **자체 개발 API**를 함께 활용합니다.

### 자체 개발 API
- **디지털 피로도 측정 API (Digital Fatigue API)**
  - **역할**: 스마트 미러의 카메라로 사용자의 얼굴을 실시간 분석하여, 눈 깜빡임 빈도, 하품 감지 등을 통해 피로도를 측정하는 독자 개발 API입니다.
  - **개발 환경**: Python, OpenCV, MediaPipe

- **[OpenWeatherMap API](https://openweathermap.org/api)**: 현재 날씨 및 예보 데이터를 가져오기 위해 사용됩니다.
- **[Google Calendar API](https://developers.google.com/calendar/api)**: 개인 구글 캘린더의 일정을 연동하기 위해 사용됩니다.
- **[Google Assistant API](https://developers.google.com/assistant/sdk)**: 음성 명령 인식 및 처리를 위해 사용됩니다.
- **[Google Photos Library API](https://developers.google.com/photos/library/reference/rest)**: 구글 포토 앨범의 사진을 디지털 액자 형태로 가져오기 위해 사용됩니다.
- **[YouTube Data API v3](https://developers.google.com/youtube/v3)**: 음성 명령을 통해 유튜브 영상을 검색하고 재생하기 위해 사용됩니다.

<br />

## ⚙ 기술 스택

본 프로젝트는 임베디드 시스템의 특성을 가지며, 하드웨어부터 외부 서비스까지 여러 기술 계층의 조합으로 구성됩니다.

### Hardware

- **Raspberry Pi 4**: 프로젝트의 핵심 컴퓨팅 모듈입니다. OS를 구동하고 모든 소프트웨어 로직을 처리합니다.
- **USB Webcam**: **'디지털 피로도 측정 API'**의 영상 입력을 담당하는 핵심 센서입니다.
- **10.1" Touch Display**: 사용자 인터페이스(UI)를 표시하고, 터치 입력을 통해 화면을 제어하는 역할을 합니다.
- **USB Microphone & Speaker**: 구글 어시스턴트의 음성 입출력을 담당하는 핵심 주변 장치입니다.
- **Half Mirror Film & Acrylic**: 디스플레이 화면을 거울처럼 보이게 하는 물리적 핵심 부품입니다.
- **PIR Sensor / Tact Switch**: 터치가 불가능한 환경에서 화면 절전 모드를 제어하기 위한 대체 입력 장치입니다.

### Core Software & Platform

- **Raspberry Pi OS**: 안정적인 구동 환경을 제공하는 Debian 기반의 운영체제입니다.
- **MagicMirror²**: 모듈형 구조를 가진 오픈소스 스마트 미러 플랫폼으로, 프로젝트의 애플리케이션 프레임워크 역할을 합니다.
- **Node.js**: MagicMirror의 런타임 환경으로, 서버 사이드 로직과 모듈 관리를 담당합니다.
- **JavaScript (ES6)**: MagicMirror의 모듈을 커스터마이징하고 개발하는 데 사용되는 주력 언어입니다.
- **Python (Flask/FastAPI)**: **'디지털 피로도 측정 API'**를 구동하는 AI 추론 서버를 구축하는 데 사용됩니다.
- **OpenCV / MediaPipe**: 실시간 영상 처리 및 얼굴 랜드마크 추출을 위한 핵심 라이브러리입니다.

### Tools & Environment

- **Git & Github**: 각종 모듈의 소스 코드를 클론하고 버전을 관리합니다.
- **SSH (PuTTY)**: 원격으로 라즈베리파이에 접속하여 모든 개발 및 설정 작업을 수행합니다.
- **NPM**: Node.js의 패키지 매니저로, 모듈 의존성 설치 및 스크립트 실행에 사용됩니다.
- **PM2**: Node.js 애플리케이션(MagicMirror)을 백그라운드에서 안정적으로 실행하고 관리하는 프로세스 매니저입니다.

<br />

## 🛠️ 프로젝트 아키텍쳐

이 프로젝트는 **마이크로서비스 아키텍처(MSA)**를 도입하여, Node.js로 구현된 메인 서버와 Python으로 구현된 AI 서버가 독립적으로 동작하며 내부 API를 통해 통신하는 구조를 가집니다.

- **Layer 1: Hardware Layer**

  - 라즈베리파이, 카메라, 터치 디스플레이, 마이크/스피커 등 물리적 장치로 구성됩니다.

- **Layer 2: System Layer**

  - Raspberry Pi OS가 하드웨어를 제어하고, Node.js와 Python 런타임 환경을 제공합니다.

- **Layer 3: Application & Module Layer**

  - **Node.js Main Server**: MagicMirror² 플랫폼이 UI와 기본 모듈(날씨, 캘린더 등)을 제어합니다.
  - **Python AI Server**: 자체 개발한 **'디지털 피로도 측정 API'**를 실행하며, 영상 분석 및 추론을 전담합니다.
  - **Internal API**: 두 서버는 HTTP 통신을 통해 실시간으로 데이터를 주고받습니다.

- **Layer 4: External Service Layer**
  - Google, OpenWeatherMap 등 외부 API 서버와 통신하여 필요한 데이터를 가져옵니다.

> **데이터 흐름 예시**: 사용자가 "오늘 날씨 알려줘"라고 말하면, `하드웨어 계층`(마이크)이 음성을 입력받아 `모듈 계층`(구글 어시스턴트)에 전달합니다. 모듈은 `외부 서비스 계층`(구글 API, 날씨 API)과 통신하여 데이터를 가져온 후, `애플리케이션 계층`을 통해 가공하여 `하드웨어 계층`(디스플레이/스피커)으로 최종 정보를 출력합니다.

<br />

## 🤔 기술적 이슈와 해결 과정

프로젝트 진행 중 발생했던 주요 기술적 난관과 이를 해결하기 위한 접근 방식을 공유합니다.

<br />

### API 연동 및 데이터 흐름 설계

MagicMirror는 nodejs기반이고 자체제작 api는 파이썬기반입니다. 이 호환성문제를 해결하기위해
자체 개발 API와 외부 API를 연동하여 시너지를 내기 위해 다음과 같은 데이터 처리 방식을 설계했습니다.

** 독립적인 호출 및 병렬 표시 (Dashboard Approach)**

가장 기본적이고 안정적인 데이터 처리 방식입니다. 각 API를 독립적으로 호출하고, 그 결과들을 화면의 각기 다른 위치에 동시에 보여주는 대시보드 형태로 구성합니다.

-   **개념**: 메인 서버(Node.js)가 여러 API(Google, 피로도 측정 API 등)에게 각자 할 일을 시키고, 결과 보고를 따로따로 받아 한 번에 취합해서 화면에 표시합니다. API끼리는 서로 직접 소통하지 않습니다.

-   **동작 예시**:
    1.  메인 서버가 Google API에 "오늘 일정 뭐야?"라고 묻습니다.
    2.  동시에, 메인 서버가 자체 개발한 피로도 측정 API에 "현재 피로도 얼마야?"라고 묻습니다.
    3.  Google에서는 '오후 3시 회의'라는 답변을, 피로도 API에서는 '82점'이라는 답변을 각각 받습니다.
    4.  메인 서버는 화면 좌측에 '오후 3시 회의'를, 우측에는 '피로도: 82점'을 각각 표시합니다.



</br>

## 💁‍♂️ 프로젝트 팀원

|              Project Lead & Developer               |
| :-------------------------------------------------: |

